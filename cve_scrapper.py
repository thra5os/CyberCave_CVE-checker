import pandas as pd
import requests
import re

def save_mitre_cve_page(app_name, app_version):
    search_query = f'Adobe+{app_name.lower().replace(" ", "+")}+{app_version}'
    url = f'https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword={search_query}'

    response = requests.get(url)

    if response.status_code == 200:
        # Save the HTML page with a filename based on the app name and version
        filename = f'{app_name.replace(" ", "_")}_version_{app_version}.html'
        with open(filename, 'w', encoding='utf-8') as f:
            f.write(response.text)
        print(f"HTML page saved for {app_name} version {app_version}: {filename}")
    else:
        print(f"Failed to fetch HTML page for {app_name} version {app_version}. Status code: {response.status_code}")

apps = pd.read_csv('apps.csv')
apps = apps.dropna()

apps['DisplayVersion'] = apps['DisplayVersion'].apply(lambda x: re.findall(r'\b\d+(?:\.\d+)*\b', x))

# Save the HTML page for each app and its version
for index, row in apps.iterrows():
    app_name = row['DisplayName']
    app_version = row['DisplayVersion']
    save_mitre_cve_page(app_name, app_version)
