import os
import subprocess
import pandas as pd

#to get the path of the powershell 
powershell_path = r'C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe'


#the command to get the list of application and their versions
powershell_command = r'Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object DisplayName, DisplayVersion | Export-Csv -Path apps.csv -NoTypeInformation'

#to actually execute the command
subprocess.call([powershell_path, "-Command", powershell_command], shell=True)

#use of pandas to remove all empty lines
apps = pd.read_csv('apps.csv')
apps = apps.dropna(how='all')
print(apps.head(8))

#to convert the pandas dataframe to an array
applications_array = apps.values.tolist()

#to delete the csv file :
#subprocess.call([powershell_path, "-Command", "rm apps.csv", shell=True)
