import subprocess
import pandas as pd

powershell_path = r'C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe'
powershell_command = r'Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object DisplayName, Publisher, InstallDate, DisplayVersion | Export-Csv -Path "C:\Users\thrasos\Documents\Hackathon_SiliconDays_2024\Applications.csv" -NoTypeInformation'
subprocess.call([powershell_path, "-Command", powershell_command], shell=True)

apps = pd.read_csv('Applications.csv')
print(apps.head(8))
